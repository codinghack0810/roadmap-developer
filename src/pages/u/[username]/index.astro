---
import { userApi } from '../../../api/user';
import AccountLayout from '../../../layouts/AccountLayout.astro';
import { UserPublicProfilePage } from '../../../components/UserPublicProfile/UserPublicProfilePage';

interface Params extends Record<string, string | undefined> {
  username: string;
}

const { username } = Astro.params as Params;
if (!username) {
  return Astro.redirect('/404');
}

const userClient = userApi(Astro as any);
const { response: userDetails, error } =
  await userClient.getPublicProfile(username);

if (error || !userDetails) {
  return Astro.redirect('/404');
}
---

<AccountLayout title={userDetails?.name}>
  <UserPublicProfilePage {...userDetails} client:load />
</AccountLayout>
